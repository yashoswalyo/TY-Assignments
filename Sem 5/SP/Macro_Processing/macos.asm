MACRO
CLRMEM &X,&N,&REG=BREG 
LCL &M
&S SET 0
MOVER &REG = '0'
.MORE MOVEM &REG,&X + &S
&S SET &S + 1
AIF (&M NE &N ) .MORE
MEND
MACRO
DECR &A,&B
MOVER BREG,&A
SUB BREG,&B
MOVEM BREG,&A
MEND
MACRO
DESCOR &D,&E
MOVER BREG,&D
SUB BREG,&E
MOVEM BREG,&D
MEND
MACRO
DOMATH &Q,&W,&R=AREG,&KEY=CREG
LCL &V
&V SET 0
MOVER &R = '0'
.ADD MOVEM &R,&Q + &V
&V SET &V + 1
AIF (&V NE &W ) .ADD
MEND
MACRO
DECR &P,&Q
MOVER BREG,&P
SUB BREG,&Q
MOVEM BREG,&P
MEND